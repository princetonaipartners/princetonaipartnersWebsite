@tailwind base;
@tailwind components;
@tailwind utilities;

@property --angle {
  syntax: "<angle>";
  initial-value: 0deg;
  inherits: false;
}

@layer base {
  /* shadcn/ui compatible CSS tokens - mapped to Princeton AI brand */
  :root {
    --background: 250 250 250;
    --foreground: 15 15 15;
    --card: 255 255 255;
    --card-foreground: 15 15 15;
    --popover: 255 255 255;
    --popover-foreground: 15 15 15;
    --primary: 10 132 255;
    --primary-foreground: 255 255 255;
    --secondary: 245 245 245;
    --secondary-foreground: 15 15 15;
    --muted: 245 245 245;
    --muted-foreground: 107 114 128;
    --accent: 229 242 255;
    --accent-foreground: 0 61 130;
    --destructive: 239 68 68;
    --destructive-foreground: 255 255 255;
    --border: 229 231 235;
    --input: 229 231 235;
    --ring: 10 132 255;
    --radius: 1rem;
  }

  .dark {
    --background: 9 9 11;
    --foreground: 250 250 250;
    --card: 39 39 42;
    --card-foreground: 250 250 250;
    --popover: 24 24 27;
    --popover-foreground: 250 250 250;
    --primary: 59 159 255;
    --primary-foreground: 9 9 11;
    --secondary: 39 39 42;
    --secondary-foreground: 250 250 250;
    --muted: 39 39 42;
    --muted-foreground: 161 161 170;
    --accent: 26 58 82;
    --accent-foreground: 59 159 255;
    --destructive: 220 38 38;
    --destructive-foreground: 250 250 250;
    --border: 63 63 70;
    --input: 63 63 70;
    --ring: 59 159 255;
  }

  * {
    @apply border-border;
  }

  html {
    @apply scroll-smooth;
  }

  body {
    @apply bg-surface-primary text-text-primary font-sans antialiased;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  /* Dark mode overrides - transparent body to allow PageBackground to show through */
  .dark body {
    @apply bg-transparent text-dark-text-primary;
  }

  h1, h2, h3, h4, h5, h6 {
    @apply font-bold;
  }

  .dark h1, .dark h2, .dark h3, .dark h4, .dark h5, .dark h6 {
    @apply text-dark-text-primary;
  }

  /* Focus states for accessibility */
  a:focus-visible,
  button:focus-visible,
  input:focus-visible,
  textarea:focus-visible,
  select:focus-visible,
  [tabindex]:focus-visible {
    @apply outline-none ring-2 ring-brand-primary ring-offset-2 ring-offset-zinc-900;
  }

  /* Remove default focus outline since we're using ring */
  :focus {
    outline: none;
  }

  /* Reduced motion for accessibility */
  @media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
      scroll-behavior: auto !important;
    }
  }
}

@layer utilities {
  /* Custom utility classes */
  .text-balance {
    text-wrap: balance;
  }

  /* Accordion animations */
  @keyframes accordion-down {
    from {
      height: 0;
      opacity: 0;
    }
    to {
      height: var(--radix-accordion-content-height);
      opacity: 1;
    }
  }

  @keyframes accordion-up {
    from {
      height: var(--radix-accordion-content-height);
      opacity: 1;
    }
    to {
      height: 0;
      opacity: 0;
    }
  }

  .animate-accordion-down {
    animation: accordion-down 0.2s ease-out;
  }

  .animate-accordion-up {
    animation: accordion-up 0.2s ease-out;
  }

  /* Wave animations */
  @keyframes wave {
    0%, 100% {
      background-position: 0% 50%;
    }
    50% {
      background-position: 100% 50%;
    }
  }

  .animate-wave {
    animation: wave 8s ease-in-out infinite;
  }

  .animate-wave-slow {
    animation: wave 12s ease-in-out infinite;
  }

  /* Animation delay utilities */
  .delay-100 {
    animation-delay: 100ms;
  }
  .delay-200 {
    animation-delay: 200ms;
  }
  .delay-300 {
    animation-delay: 300ms;
  }
  .delay-500 {
    animation-delay: 500ms;
  }
  .delay-700 {
    animation-delay: 700ms;
  }

  /* Gradient fade mask */
  .fade-top-lg {
    mask-image: linear-gradient(to bottom,
      transparent,
      rgba(0, 0, 0, 1) 8rem
    );
  }

  /* RetroGrid animation - scrolls toward viewer */
  @keyframes grid {
    0% {
      transform: translateY(-50%);
    }
    100% {
      transform: translateY(0);
    }
  }

  /* Orbit animation for tech stack */
  @keyframes orbit {
    0% {
      transform: rotate(0deg);
    }
    100% {
      transform: rotate(360deg);
    }
  }

  /* Counter-orbit to keep icons upright while orbiting */
  @keyframes counter-orbit {
    0% {
      transform: rotate(0deg);
    }
    100% {
      transform: rotate(-360deg);
    }
  }

  /* Legacy orbit with translateX (for backwards compatibility) */
  @keyframes orbit-translate {
    0% {
      transform: rotate(0deg) translateX(var(--radius, 100px)) rotate(0deg);
    }
    100% {
      transform: rotate(360deg) translateX(var(--radius, 100px)) rotate(-360deg);
    }
  }

  /* Beam pulse for architecture diagrams */
  @keyframes beam-pulse {
    0% {
      opacity: 0.2;
      transform: translateX(-100%);
    }
    50% {
      opacity: 1;
    }
    100% {
      opacity: 0.2;
      transform: translateX(100%);
    }
  }

  /* Typing cursor blink */
  @keyframes blink {
    0%, 100% {
      opacity: 1;
    }
    50% {
      opacity: 0;
    }
  }
}

/* ============================================
   THEME TRANSITION (Scoped for Performance)
   ============================================ */

/* Only apply theme transitions to specific elements - NOT universal selector */
/* This prevents layout/paint overhead from global transitions */
body,
a,
button,
input,
select,
textarea,
.card,
[class*="bg-"],
[class*="text-"],
[class*="border-"] {
  transition-property: color, background-color, border-color;
  transition-timing-function: cubic-bezier(0.22, 1, 0.36, 1);
  transition-duration: 200ms;
}

/* Disable transitions for specific elements during page load */
html.no-transitions *,
html.no-transitions *::before,
html.no-transitions *::after {
  transition: none !important;
}

/* View Transition API - Directional Wipe Effect (Modern Browsers) */
@supports (view-transition-name: none) {
  /* Customize the default cross-fade */
  ::view-transition-old(root),
  ::view-transition-new(root) {
    animation-duration: 0.5s;
    animation-timing-function: cubic-bezier(0.22, 1, 0.36, 1);
  }

  /* Old state slides out to the left */
  ::view-transition-old(root) {
    animation-name: slide-out-left;
  }

  /* New state slides in from the right */
  ::view-transition-new(root) {
    animation-name: slide-in-right;
  }

  @keyframes slide-out-left {
    from {
      transform: translateX(0);
    }
    to {
      transform: translateX(-30%);
      opacity: 0;
    }
  }

  @keyframes slide-in-right {
    from {
      transform: translateX(30%);
      opacity: 0;
    }
    to {
      transform: translateX(0);
      opacity: 1;
    }
  }
}

/* Fallback for browsers without View Transition API */
@supports not (view-transition-name: none) {
  html {
    transition: background-color 0.4s cubic-bezier(0.22, 1, 0.36, 1);
  }

  body {
    transition: color 0.4s cubic-bezier(0.22, 1, 0.36, 1);
  }
}
