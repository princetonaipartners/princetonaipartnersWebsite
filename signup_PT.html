<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Join Hamilton Deli & Grill Rewards</title>
<style>
  :root{
    --bg:#0b1020; --card:#101629; --ink:#e8ecff; --muted:#9aa3b2;
    --brand:#5fe1a5; --brand2:#55c9ff; --accent:#ffd166;
    --ring:#2a375a; --shadow:0 10px 30px rgba(0,0,0,.35); --radius:16px;
  }
  html,body{margin:0;height:100%;background:
    radial-gradient(80% 140% at 10% -10%, rgba(85,201,255,.18), transparent 55%),
    radial-gradient(60% 120% at 110% -10%, rgba(95,225,165,.15), transparent 45%),
    var(--bg); color:var(--ink); font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Inter,Roboto,Arial;}
  .wrap{max-width:720px;margin:28px auto;padding:0 18px}
  .card{background:var(--card);border-radius:16px;box-shadow:var(--shadow);padding:22px;position:relative}
  h1{margin:0 0 6px;font-weight:800}
  .sub{color:var(--muted);margin-bottom:14px}
  .field{display:flex;flex-direction:column;gap:6px;margin-top:10px}
  label{font-weight:700}
  input[type="text"],input[type="tel"],input[type="email"]{
    background:#0e1425;color:#fff;border:1px solid #243055;border-radius:12px;padding:14px;font-size:16px;outline:none}
  input:focus{box-shadow:0 0 0 3px var(--ring);border-color:#37508f}
  .hint{color:var(--muted);font-size:13px}
  .row{display:flex;align-items:center;gap:10px}
  .actions{margin-top:16px}
  button{width:100%;padding:15px;border:none;border-radius:12px;font-weight:800;font-size:16px;cursor:pointer}
  .primary{background:linear-gradient(180deg,var(--brand),var(--brand2));color:#08111f}
  .ghost{background:#0e1425;color:#c7d2fe;border:1px solid #2b355a}
  button[disabled]{opacity:.7;cursor:not-allowed}
  .banner{display:none;margin-bottom:12px;padding:12px 14px;border-radius:12px;font-weight:700}
  .ok{background:#123724;color:#9ff3c9;border:1px solid #1f6b49}
  .warn{background:#3a2a07;color:#ffe2a6;border:1px solid #8d6b19}
  .err{background:#3d0f17;color:#ffd0d8;border:1px solid #8f2236}
  .promo{margin-top:14px;padding:12px;border:1px dashed #555;border-radius:12px;background:#0f1527}
  .promo b{color:#ffd166}
  .cta-row{display:flex;flex-wrap:wrap;gap:10px;margin-top:12px}
  .cta{display:inline-block;text-decoration:none;font-weight:800;border:1px solid #2b355a;border-radius:10px;padding:10px 12px;color:#dbe1ff;background:#0e1425}
  .cta:hover{background:#0f162a}
  .loading[hidden]{display:none !important;}
  .loading{position:absolute;inset:0;background:rgba(10,14,25,.55);backdrop-filter:blur(1px);
           border-radius:16px;display:flex;align-items:center;justify-content:center;gap:10px;z-index:5}
  .spinner{width:20px;height:20px;border-radius:50%;border:3px solid rgba(85,201,255,.25);border-top-color:#55c9ff;animation:spin .9s linear infinite}
  @keyframes spin{to{transform:rotate(360deg)}}
</style>
</head>
<body>
<div class="wrap">
  <div class="card" id="formCard" aria-live="polite">
    <div class="loading" id="loading" hidden>
      <div class="spinner" aria-hidden="true"></div><div>Submitting‚Ä¶</div>
    </div>

    <h1>Join Hamilton Deli & Grill Rewards</h1>
    <div class="sub">Earn points on every purchase and unlock free drinks.</div>

    <!-- $5 review bonus promo -->
    <div class="promo">
      <b>$5 off your next purchase:</b> after you join, <u>leave us a Google review</u> and show the cashier‚Äîyour $5 review bonus will be applied at checkout.
      <div class="cta-row">
        <a class="cta" id="reviewLink" target="_blank" rel="noopener">‚≠ê Leave a Google Review</a>
      </div>
    </div>

    <div class="banner warn" id="warnBanner"></div>
    <div class="banner err"  id="errBanner"></div>
    <div class="banner ok"   id="okBanner"></div>

    <form id="theForm" novalidate>
      <div class="field">
        <label for="phone">üìû Phone number *</label>
        <input id="phone" type="tel" inputmode="tel" autocomplete="tel" placeholder="(555) 123-4567"/>
        <div class="hint">Digits only; last 10 are used.</div>
      </div>

      <div class="field">
        <label for="name">üë§ Full name *</label>
        <input id="name" type="text" autocomplete="name" placeholder="Jane Doe"/>
      </div>

      <div class="field">
        <label for="birthday">üéÇ Birthday *</label>
        <input id="birthday" type="text" inputmode="numeric" placeholder="yyyy-mm-dd" maxlength="10"/>
        <div class="hint">Format: <b>YYYY-MM-DD</b>. Hyphens insert automatically.</div>
      </div>

      <div class="field">
        <label for="email">‚úâÔ∏è Email (optional)</label>
        <input id="email" type="email" autocomplete="email" placeholder="jane@example.com"/>
      </div>

      <div class="field">
        <label class="row">
          <input id="smsOptin" type="checkbox" checked/>
          <span>Send me exclusive offers & rewards via SMS</span>
        </label>
      </div>

      <div class="actions">
        <button class="primary" id="btnJoin" type="submit">
          <span class="btn-label">Join rewards</span>
        </button>
      </div>
    </form>
  </div>

  <!-- Success card -->
  <div class="card" id="doneCard" style="display:none" aria-live="polite">
    <div class="banner ok" style="display:block">You‚Äôre all set! üéâ</div>
    <p style="margin:8px 0 12px;color:#cfe6ff">
      Tell the cashier your phone number at checkout. If you leave us a review now and show it to the cashier, you‚Äôll receive <b>$5 off</b> your next purchase.
    </p>
    <div class="cta-row">
      <a class="cta" id="reviewLink2" target="_blank" rel="noopener">‚≠ê Leave a Google Review</a>
      <a class="cta" id="backBtn" href="#" role="button">‚Üê Back to form</a>
    </div>
  </div>
</div>

<script>
/* ===== CONFIG ===== */
const SIGNUP_WEBHOOK = 'https://princetonai.app.n8n.cloud/webhook/cashier-signup';
const GOOGLE_REVIEW_URL = 'https://www.google.com/search?sca_esv=7c6c3e386d10efbb&rlz=1C1VDKB_enUS1111US1111&sxsrf=AE3TifPDTSY_1vKuJTDwrgIzhzFKms7MBg:1758691417730&si=AMgyJEtREmoPL4P1I5IDCfuA8gybfVI2d5Uj7QMwYCZHKDZ-E4MQScdB3haeo5WTi8cfBo-3sf0b6XZPgFwWBCNZisb62KNCOpCPImErw7oenzP9CZ1Jk2yL5zvLs1jAN0cCxO0o-znlC0WnWkbzwAUpxTc9vJiRjg%3D%3D&q=Hamilton+Deli+%26+Grill+Reviews&sa=X&ved=2ahUKEwjhuuSJ1PCPAxXQD1kFHUWRNH4Q0bkNegQIOhAE&biw=1536&bih=826&dpr=1.25';
/* =================== */

document.getElementById('reviewLink').href  = GOOGLE_REVIEW_URL;
document.getElementById('reviewLink2').href = GOOGLE_REVIEW_URL;

function $(q){ return document.querySelector(q); }
function show(el, on){ el.style.display = on ? 'block' : 'none'; }
function digits10(v){ const d = String(v||'').replace(/\D/g,''); return d.length>=10 ? d.slice(-10) : null; }
function clearBanners(){ ['okBanner','warnBanner','errBanner'].forEach(id => { const el = $('#'+id); el.style.display='none'; el.textContent=''; }); }
function setBanner(id, cls, msg){ const el = $('#'+id); el.className = 'banner ' + cls; el.textContent = msg; el.style.display='block'; }

(function birthdayMask(){
  const el = $('#birthday');
  el.addEventListener('input', () => {
    const digits = el.value.replace(/\D/g,'').slice(0,8);
    let out=''; if(digits.length<=4) out=digits;
    else if(digits.length<=6) out = digits.slice(0,4)+'-'+digits.slice(4);
    else out = digits.slice(0,4)+'-'+digits.slice(4,6)+'-'+digits.slice(6);
    el.value = out;
  });
})();

async function submitForm(e){
  e.preventDefault();
  clearBanners();

  const phone10 = digits10($('#phone').value);
  const name    = $('#name').value.trim();
  const bday    = $('#birthday').value.trim();
  const email   = $('#email').value.trim();
  const smsOpt  = $('#smsOptin').checked;

  if(!phone10){ setBanner('warnBanner','warn','Please enter a valid phone number.'); return; }
  if(!name){ setBanner('warnBanner','warn','Please enter your full name.'); return; }
  if(!/^\d{4}-\d{2}-\d{2}$/.test(bday)){ setBanner('warnBanner','warn','Birthday must be YYYY-MM-DD.'); return; }

  // Loading state
  const btn = $('#btnJoin'); const label = btn.querySelector('.btn-label');
  $('#loading').hidden = false; btn.disabled = true; label.textContent = 'Submitting‚Ä¶';

  try{
    const res = await fetch(SIGNUP_WEBHOOK + `?t=${Date.now()}`, {
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify({ phone: phone10, name, birthday: bday, email, smsOptin: smsOpt })
    });
    if(!res.ok) throw new Error('HTTP '+res.status);
    const data = await res.json();

    // Success -> show done card with review CTA
    show($('#formCard'), false);
    show($('#doneCard'), true);
  }catch(err){
    console.error(err);
    setBanner('errBanner','err','Sign-up failed. Please try again.');
  }finally{
    $('#loading').hidden = true; btn.disabled = false; label.textContent = 'Join rewards';
  }
}

$('#theForm').addEventListener('submit', submitForm);
$('#backBtn').addEventListener('click', (e)=>{ e.preventDefault(); show($('#doneCard'), false); show($('#formCard'), true); });
</script>
</body>
</html>